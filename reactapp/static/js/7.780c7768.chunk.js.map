{"version":3,"sources":["images/svg/eye.svg","images/svg/key.svg","images/svg/sms.svg","images/svg/user.svg","images/wellcome.png","views/Signup.js"],"names":["module","exports","__webpack_require__","p","actionTypes","username","email","password","confirmPassword","checkbox","formValueReducers","state","action","type","Object","E_Python_MallorcaMagc_clean_for_deploy_mallorcamagic_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__","value","isValid","length","isValidEMail","SignUp","_useState","useState","_useState2","E_Python_MallorcaMagc_clean_for_deploy_mallorcamagic_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__","showPassword","setShowPassword","_useState3","_useState4","showConfirmPassword","setShowConfirmPassword","_useReducer","useReducer","_useReducer2","formValues","dispatch","_useState5","_useState6","error","setError","_useState7","_useState8","isLoading","setIsLoading","_useRecoilState","useRecoilState","AuthToken","loggedUser","useRecoilValue","LoggedUser","navigate","useNavigate","_useState9","_useState10","recaptchaToken","setRecaptchaToken","recaptchaRef","useRef","isLoggedIn","showPasswordHandler","useCallback","showConfirmPasswordHandler","handleChange","e","target","name","handleCheckbox","handleSubmit","axios","post","concat","HOST_NAME","confirm","recaptcha","then","res","status","catch","err","response","data","finally","current","reset","react__WEBPACK_IMPORTED_MODULE_2___default","a","createElement","className","_containers_DefaultLayout__WEBPACK_IMPORTED_MODULE_11__","coverImage","Wellcome","coverText","_components_Title__WEBPACK_IMPORTED_MODULE_10__","text","react_inlinesvg__WEBPACK_IMPORTED_MODULE_8__","src","User","placeholder","onChange","Email","Password","onClick","Eye","react_router_dom__WEBPACK_IMPORTED_MODULE_9__","to","react_google_recaptcha__WEBPACK_IMPORTED_MODULE_18__","sitekey","GOOGLE_RECAPTCHA_SITE_KEY","token","ref","disabled"],"mappings":"6EAAAA,EAAAC,QAAiBC,EAAAC,EAAuB,qDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,qDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,qDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,sDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,yUCkBlCC,EAAc,CAClBC,SAAU,WACVC,MAAO,QACPC,SAAU,WACVC,gBAAiB,kBACjBC,SAAU,YAGNC,EAAoB,SAACC,EAAOC,GAChC,OAAQA,EAAOC,MACb,KAAKT,EAAYC,SACf,OAAOS,OAAAC,EAAA,EAAAD,CAAA,GAAKH,EAAZ,CAAmBN,SAAUO,EAAOI,MAAOC,QAASN,EAAMF,UAAYG,EAAOI,MAAME,OAAS,IAE9F,KAAKd,EAAYE,MACf,OAAOQ,OAAAC,EAAA,EAAAD,CAAA,GAAKH,EAAZ,CAAmBL,MAAOM,EAAOI,MAAOC,QAASN,EAAMF,UAAYU,YAAaP,EAAOI,SAEzF,KAAKZ,EAAYG,SACf,OAAOO,OAAAC,EAAA,EAAAD,CAAA,GAAKH,EAAZ,CAAmBJ,SAAUK,EAAOI,MAAOC,QAASN,EAAMF,UAAYG,EAAOI,MAAME,OAAS,GAAKN,EAAOI,QAAUL,EAAMH,kBAE1H,KAAKJ,EAAYI,gBACf,OAAOM,OAAAC,EAAA,EAAAD,CAAA,GAAKH,EAAZ,CAAmBH,gBAAiBI,EAAOI,MAAOC,QAASN,EAAMF,UAAYG,EAAOI,MAAME,OAAS,GAAKN,EAAOI,QAAUL,EAAMJ,WAEjI,KAAKH,EAAYK,SACf,OAAOK,OAAAC,EAAA,EAAAD,CAAA,GAAKH,EAAZ,CAAmBF,SAAUG,EAAOI,MAAOC,QAASL,EAAOI,QAE7D,QACE,OAAOL,IAIAS,EAAS,WAAM,IAAAC,EACcC,oBAAS,GADvBC,EAAAT,OAAAU,EAAA,EAAAV,CAAAO,EAAA,GACnBI,EADmBF,EAAA,GACLG,EADKH,EAAA,GAAAI,EAE4BL,oBAAS,GAFrCM,EAAAd,OAAAU,EAAA,EAAAV,CAAAa,EAAA,GAEnBE,EAFmBD,EAAA,GAEEE,EAFFF,EAAA,GAAAG,EAGKC,qBAAWtB,EAAmB,CAAEL,SAAU,GAAIC,MAAO,GAAIC,SAAU,GAAIC,gBAAiB,GAAIC,UAAU,EAAOQ,SAAS,IAH3HgB,EAAAnB,OAAAU,EAAA,EAAAV,CAAAiB,EAAA,GAGnBG,EAHmBD,EAAA,GAGPE,EAHOF,EAAA,GAAAG,EAIAd,mBAAS,IAJTe,EAAAvB,OAAAU,EAAA,EAAAV,CAAAsB,EAAA,GAInBE,EAJmBD,EAAA,GAIZE,EAJYF,EAAA,GAAAG,EAKQlB,oBAAS,GALjBmB,EAAA3B,OAAAU,EAAA,EAAAV,CAAA0B,EAAA,GAKnBE,EALmBD,EAAA,GAKRE,EALQF,EAAA,GAAAG,EAODC,YAAeC,KAClCC,GARoBjC,OAAAU,EAAA,EAAAV,CAAA8B,EAAA,MAQPI,YAAeC,MAC5BC,EAAWC,cATSC,EAYkB9B,mBAAS,IAZ3B+B,EAAAvC,OAAAU,EAAA,EAAAV,CAAAsC,EAAA,GAYnBE,EAZmBD,EAAA,GAYHE,EAZGF,EAAA,GAapBG,EAAeC,mBAEjBV,EAAWW,YACbR,EAAS,qBAGX,IAAMS,EAAsBC,sBAAY,WACtClC,GAAiBD,IAChB,CAACA,IAEEoC,EAA6BD,sBAAY,WAC7C9B,GAAwBD,IACvB,CAACA,IAEEiC,EAAeF,sBAAY,SAACG,GAChC5B,EAAS,CAAEtB,KAAMT,EAAY2D,EAAEC,OAAOC,MAAOjD,MAAO+C,EAAEC,OAAOhD,SAE5D,CAACkB,IAEEgC,EAAiBN,sBAAY,WACjCzB,EAAS,CAAEtB,KAAMT,EAAYK,SAAUO,OAAQkB,EAAWzB,YACzD,CAACyB,IAEEiC,EAAeP,sBAAY,WAC1B1B,EAAWjB,SACXqC,IAELX,GAAa,GACbyB,IAAMC,KAAN,GAAAC,OAAcC,IAAd,wBAA+C,CAC7ClE,SAAU6B,EAAW7B,SACrBC,MAAO4B,EAAW5B,MAClBC,SAAU2B,EAAW3B,SACrBiE,QAAStC,EAAW1B,gBACpBiE,UAAWnB,IAEVoB,KAAK,SAAAC,GACe,MAAfA,EAAIC,SACN1B,EAAS,UACTX,EAAS,OAGZsC,MAAM,SAAAC,GACLvC,EAASuC,EAAIC,SAASC,KAAK1C,SAE5B2C,QAAQ,WACPtC,GAAa,GACbY,EAAkB,IACdC,EAAa0B,SAAS1B,EAAa0B,QAAQC,YAElD,CAACjD,EAAYoB,EAAgBE,IAEhC,OACE4B,EAAAC,EAAAC,cAAA,OAAKC,UAAU,yBACbH,EAAAC,EAAAC,cAACE,EAAA,EAAD,CAAeC,WAAYC,IAAUC,UAAU,6BAC7CP,EAAAC,EAAAC,cAAA,OAAKC,UAAU,kBACbH,EAAAC,EAAAC,cAAA,WACEF,EAAAC,EAAAC,cAACM,EAAA,EAAD,CAAOC,KAAK,2BAEVvD,GAAS8C,EAAAC,EAAAC,cAAA,OAAKC,UAAU,SAAQH,EAAAC,EAAAC,cAAA,SAAIhD,IAEtC8C,EAAAC,EAAAC,cAAA,OAAKC,UAAU,UACbH,EAAAC,EAAAC,cAAA,yBACAF,EAAAC,EAAAC,cAAA,OAAKC,UAAU,SACbH,EAAAC,EAAAC,cAACQ,EAAA,EAAD,CAAMC,IAAKC,MACXZ,EAAAC,EAAAC,cAAA,SAAOzE,KAAK,OAAOoF,YAAY,qBAAqBhC,KAAK,WAAWjD,MAAOkB,EAAW7B,SAAU6F,SAAUpC,KAE5GsB,EAAAC,EAAAC,cAAA,sBACAF,EAAAC,EAAAC,cAAA,OAAKC,UAAU,SACbH,EAAAC,EAAAC,cAACQ,EAAA,EAAD,CAAMC,IAAKI,MACXf,EAAAC,EAAAC,cAAA,SAAOzE,KAAK,OAAOoF,YAAY,0BAA0BhC,KAAK,QAAQjD,MAAOkB,EAAW5B,MAAO4F,SAAUpC,KAG3GsB,EAAAC,EAAAC,cAAA,yBACAF,EAAAC,EAAAC,cAAA,OAAKC,UAAU,SACbH,EAAAC,EAAAC,cAACQ,EAAA,EAAD,CAAMC,IAAKK,MACXhB,EAAAC,EAAAC,cAAA,SAAOzE,KAAMY,EAAe,OAAS,WAAYwE,YAAY,0BAA0BhC,KAAK,WAAWjD,MAAOkB,EAAW3B,SAAU2F,SAAUpC,IAC7IsB,EAAAC,EAAAC,cAAA,UAAQe,QAAS1C,GAAqByB,EAAAC,EAAAC,cAACQ,EAAA,EAAD,CAAMC,IAAKO,QAGnDlB,EAAAC,EAAAC,cAAA,iCACAF,EAAAC,EAAAC,cAAA,OAAKC,UAAU,SACbH,EAAAC,EAAAC,cAACQ,EAAA,EAAD,CAAMC,IAAKK,MACXhB,EAAAC,EAAAC,cAAA,SAAOzE,KAAMgB,EAAsB,OAAS,WAAYoE,YAAY,4BAA4BhC,KAAK,kBAAkBjD,MAAOkB,EAAW1B,gBAAiB0F,SAAUpC,IACpKsB,EAAAC,EAAAC,cAAA,UAAQe,QAASxC,GAA4BuB,EAAAC,EAAAC,cAACQ,EAAA,EAAD,CAAMC,IAAKO,QAG1DlB,EAAAC,EAAAC,cAAA,OAAKC,UAAU,iBACbH,EAAAC,EAAAC,cAAA,OAAKC,UAAU,WAAWc,QAASnC,GAAgBkB,EAAAC,EAAAC,cAAA,OAAKC,UAAWrD,EAAWzB,SAAW,QAAU,MACnG2E,EAAAC,EAAAC,cAAA,wEACMF,EAAAC,EAAAC,cAACiB,EAAA,EAAD,CAAMC,GAAG,qBAAT,yBADN,MAIFpB,EAAAC,EAAAC,cAACmB,EAAA,EAAD,CAAWlB,UAAU,gBAAgBmB,QAASC,IAA2BT,SAAU,SAAAU,GAAK,OAAIrD,EAAkBqD,IAAQC,IAAKrD,IAE3H4B,EAAAC,EAAAC,cAAA,OAAKC,UAAU,WACbH,EAAAC,EAAAC,cAAA,WACEF,EAAAC,EAAAC,cAACiB,EAAA,EAAD,CAAMC,GAAG,UAAT,SACApB,EAAAC,EAAAC,cAACiB,EAAA,EAAD,CAAMC,GAAG,oBAAT,qBAEFpB,EAAAC,EAAAC,cAAA,UAAQwB,UAAW5E,EAAWjB,UAAYqC,EAAgB+C,QAASlC,EAAcoB,UAAW7C,EAAY,UAAY,IAApH,kBAYDtB","file":"static/js/7.780c7768.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/eye.a325a359.svg\";","module.exports = __webpack_public_path__ + \"static/media/key.fdfd460c.svg\";","module.exports = __webpack_public_path__ + \"static/media/sms.2c09bd0e.svg\";","module.exports = __webpack_public_path__ + \"static/media/user.304edb0d.svg\";","module.exports = __webpack_public_path__ + \"static/media/wellcome.1a27c3cd.png\";","import React, { useCallback, useState, useReducer, useRef } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { useRecoilState, useRecoilValue } from 'recoil';\r\nimport { LoggedUser, AuthToken } from \"../recoilState/User\"\r\nimport { HOST_NAME, GOOGLE_RECAPTCHA_SITE_KEY } from '../config';\r\nimport Isvg from 'react-inlinesvg';\r\nimport { Link } from 'react-router-dom';\r\nimport { Title } from '../components/Title';\r\nimport { DefaultLayout } from '../containers/DefaultLayout';\r\nimport Eye from '../images/svg/eye.svg';\r\nimport Password from '../images/svg/key.svg';\r\nimport Email from '../images/svg/sms.svg';\r\nimport User from '../images/svg/user.svg';\r\nimport Wellcome from '../images/wellcome.png';\r\nimport { isValidEMail } from \"../utils/helpers\";\r\nimport ReCAPTCHA from \"react-google-recaptcha\";\r\n\r\nconst actionTypes = {\r\n  username: \"username\",\r\n  email: \"email\",\r\n  password: \"password\",\r\n  confirmPassword: \"confirmPassword\",\r\n  checkbox: \"checkbox\"\r\n}\r\n\r\nconst formValueReducers = (state, action) => {\r\n  switch (action.type) {\r\n    case actionTypes.username:\r\n      return { ...state, username: action.value, isValid: state.checkbox && action.value.length > 0 };\r\n\r\n    case actionTypes.email:\r\n      return { ...state, email: action.value, isValid: state.checkbox && isValidEMail(action.value) };\r\n\r\n    case actionTypes.password:\r\n      return { ...state, password: action.value, isValid: state.checkbox && action.value.length > 5 && action.value === state.confirmPassword };\r\n\r\n    case actionTypes.confirmPassword:\r\n      return { ...state, confirmPassword: action.value, isValid: state.checkbox && action.value.length > 5 && action.value === state.password };\r\n\r\n    case actionTypes.checkbox:\r\n      return { ...state, checkbox: action.value, isValid: action.value };\r\n\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nexport const SignUp = () => {\r\n  const [showPassword, setShowPassword] = useState(false);\r\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false);\r\n  const [formValues, dispatch] = useReducer(formValueReducers, { username: \"\", email: \"\", password: \"\", confirmPassword: \"\", checkbox: false, isValid: false });\r\n  const [error, setError] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  // eslint-disable-next-line\r\n  const [, setAuthToken] = useRecoilState(AuthToken);\r\n  const loggedUser = useRecoilValue(LoggedUser);\r\n  const navigate = useNavigate();\r\n\r\n  // Rechaptcha\r\n  const [recaptchaToken, setRecaptchaToken] = useState('');\r\n  const recaptchaRef = useRef();\r\n\r\n  if (loggedUser.isLoggedIn) {\r\n    navigate(\"/account-settings\");\r\n  }\r\n\r\n  const showPasswordHandler = useCallback(() => {\r\n    setShowPassword(!showPassword);\r\n  }, [showPassword])\r\n\r\n  const showConfirmPasswordHandler = useCallback(() => {\r\n    setShowConfirmPassword(!showConfirmPassword);\r\n  }, [showConfirmPassword])\r\n\r\n  const handleChange = useCallback((e) => {\r\n    dispatch({ type: actionTypes[e.target.name], value: e.target.value });\r\n    // console.log(formValues)\r\n  }, [formValues])\r\n\r\n  const handleCheckbox = useCallback(() => {\r\n    dispatch({ type: actionTypes.checkbox, value: !formValues.checkbox });\r\n  }, [formValues])\r\n\r\n  const handleSubmit = useCallback(() => {\r\n    if (!formValues.isValid) return;\r\n    if (!recaptchaToken) return;\r\n\r\n    setIsLoading(true);\r\n    axios.post(`${HOST_NAME}api/accounts/signup/`, {\r\n      username: formValues.username,\r\n      email: formValues.email,\r\n      password: formValues.password,\r\n      confirm: formValues.confirmPassword,\r\n      recaptcha: recaptchaToken\r\n    })\r\n      .then(res => {\r\n        if (res.status === 200) {\r\n          navigate(\"/login\");\r\n          setError(\"\");\r\n        }\r\n      })\r\n      .catch(err => {\r\n        setError(err.response.data.error);\r\n      })\r\n      .finally(() => {\r\n        setIsLoading(false);\r\n        setRecaptchaToken('');\r\n        if (recaptchaRef.current) recaptchaRef.current.reset();\r\n      });\r\n  }, [formValues, recaptchaToken, recaptchaRef]);\r\n\r\n  return (\r\n    <div className=\"signup-screen-wrapper\">\r\n      <DefaultLayout coverImage={Wellcome} coverText=\"Welcome to Mallorca Magic\">\r\n        <div className=\"signup-wrapper\">\r\n          <div>\r\n            <Title text=\"Sign Up to Get Started\" />\r\n            {\r\n              error && <div className=\"error\"><p>{error}</p></div>\r\n            }\r\n            <div className=\"signup\">\r\n              <label>Username</label>\r\n              <div className=\"input\">\r\n                <Isvg src={User} />\r\n                <input type=\"text\" placeholder=\"Type your username\" name=\"username\" value={formValues.username} onChange={handleChange} />\r\n              </div>\r\n              <label>Email</label>\r\n              <div className=\"input\">\r\n                <Isvg src={Email} />\r\n                <input type=\"text\" placeholder=\"Type your Email address\" name=\"email\" value={formValues.email} onChange={handleChange} />\r\n              </div>\r\n\r\n              <label>Password</label>\r\n              <div className=\"input\">\r\n                <Isvg src={Password} />\r\n                <input type={showPassword ? \"text\" : \"password\"} placeholder=\"Enter a secure password\" name=\"password\" value={formValues.password} onChange={handleChange} />\r\n                <button onClick={showPasswordHandler}><Isvg src={Eye} /></button>\r\n              </div>\r\n\r\n              <label>Confirm password</label>\r\n              <div className=\"input\">\r\n                <Isvg src={Password} />\r\n                <input type={showConfirmPassword ? \"text\" : \"password\"} placeholder=\"Enter your password again\" name=\"confirmPassword\" value={formValues.confirmPassword} onChange={handleChange} />\r\n                <button onClick={showConfirmPasswordHandler}><Isvg src={Eye} /></button>\r\n              </div>\r\n\r\n              <div className=\"check-wrapper\">\r\n                <div className=\"checkbox\" onClick={handleCheckbox}><div className={formValues.checkbox ? \"check\" : \"\"}></div></div>\r\n                <p>By checking here indicate that I have read and agree to\r\n                  the <Link to=\"/terms-conditions\">Terms and Conditions.</Link> </p>\r\n              </div>\r\n\r\n              <ReCAPTCHA className=\"check-wrapper\" sitekey={GOOGLE_RECAPTCHA_SITE_KEY} onChange={token => setRecaptchaToken(token)} ref={recaptchaRef} />\r\n\r\n              <div className=\"buttons\">\r\n                <div>\r\n                  <Link to=\"/login\">Login</Link>\r\n                  <Link to=\"/forget-password\">Forget Password?</Link>\r\n                </div>\r\n                <button disabled={!formValues.isValid || !recaptchaToken} onClick={handleSubmit} className={isLoading ? 'loading' : ''}>Sign In</button>\r\n              </div>\r\n\r\n            </div>\r\n\r\n          </div>\r\n        </div>\r\n      </DefaultLayout>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default SignUp"],"sourceRoot":""}